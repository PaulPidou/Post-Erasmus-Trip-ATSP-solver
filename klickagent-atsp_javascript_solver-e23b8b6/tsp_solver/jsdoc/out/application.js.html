<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: application.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: application.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>"use strict";
var start = null;

/** The Application with the tsp solver implementation module:Application.
 * @module Application
 */


var distanceTable = [
	[0,14,4,10,20,4,10,33,2,10],
	[14,0,7,8,7,3,2,99,2,32],
	[4,5,0,7,16,12,3,1,6,9],
	[11,7,9,0,2,2,3,2,2,2],
	[18,7,17,4,0,12,3,4,5,7],
	[1,1,7,2,2,0,88,2,3,6],
	[118,7,17,4,100,2,0,5,6,22],
	[182,7,17,4,33,44,3,0,44,9],
	[1,7,17,4,2,3,33,2,0,10],
	[8,7,17,4,33,1,2,5,6,0]
];

 


var generateRandomWaypoints = function(element, callback){
	var c = document.getElementById('test_waypoints_count').value;
	if( c ){
		var worker = new Worker('application_random_matrix.js');
		worker.postMessage({ 'cmd': 'generateRandomWaypoints', 'args': c });
		worker.onmessage = function (e) {
			distanceTable = e.data;
			callback(element,c,distanceTable);
			worker.terminate();
		};
	}
};

var tsp_instance;
window.onload= function(){
	tsp_instance = new TSP();
	
	$('#inputDistanceMatrix').val(JSON.stringify(distanceTable));
	$('#distanceMatrix_c').html(jsonFormat(JSON.stringify(distanceTable)));
	
	var execution_type_input = document.getElementById('execution_type');
	var algorithm_type_input = document.getElementById('algorithm_type');
	
	var disableOptions = function( type , e){
		var obj = e.srcElement;
		var disable = function(sel,enable){
			var ops = sel.options;
			for (var i = 0; i &lt; ops.length; i++) {
				// lowercase comparison for case-insensitivity
				var value = ops[i].value;
				if( enable !== true &amp;&amp; value !== '' &amp;&amp; enable.indexOf(value.toLowerCase()) === -1 ) 
					ops[i].disabled = true;
				else 
					ops[i].disabled = false;
			}
		};
		
		var enable = eval(e.target.options[e.target.selectedIndex].dataset.allowed);
		if( type === 'algo' ){
			var showThreads = ( execution_type_input.options[execution_type_input.selectedIndex].dataset.threads );
			disable(execution_type_input,enable);
		} else if( type === 'type' ){
			var showThreads = ( e.target.options[e.target.selectedIndex].dataset.threads );
		
			disable(algorithm_type_input,enable);
		}
		if( showThreads ){
			$('#threadCount').show();
		} else {
			$('#threadCount').hide();
		}
		
	};
	
	if( algorithm_type_input )
	algorithm_type_input.addEventListener('change', function(e){ disableOptions('algo',e) } , false);	
	if(execution_type_input)
		execution_type_input.addEventListener('change', function(e){ disableOptions('type',e) }, false);	
};


/**
 * run invariant
 *
 * @param {mixed} algo - true (boolean) to autodetect best fitting algorithm for the tsp.
 * BruteForce / BnB / Dynamic / Antcolonyk2_k3 / Nearestneighbour to solve with a specific algorithm.
 * @param {mixed} mode - true (boolean) to autodetect best fitting execution mode.
 * normal / singlethread / webworker / server / server_multithread / client_distributed
 * @param {boolean} showAlgo - true, to show selected algorithm in log div
 */
var runInvariant = function(algo,mode,showAlgo){
	
	var threadCount = (mode === 'webworker' || mode === 'server_multithread') ? parseInt(document.getElementById('threadCount').value) : false;
	if( isNaN(threadCount) ) threadCount = false;
	//stop time:
	start = new Date().getTime();
	
	
	tsp_instance.init(distanceTable);
	document.getElementById('stopButton').disabled=false;
	
	tsp_instance.solve(algo,mode,threadCount,function (d) {
	    // Success
	    var end = new Date().getTime();
	    var time = end - start;
	    //console.log('Execution time: ' + time);
	    document.getElementById('log').innerHTML = 
	    	'Best Tour:' + JSON.stringify( d.bestTour ) + '&lt;br/>' + 
	    	'Weight:' + d.bestTourWeight + '&lt;br/>'+
	    	'reduced by ' + d.optimization + '% (start weight:' + d.startTourWeight +')&lt;br/>'+
	    	'Execution time: ' + time;
	    
	    if( showAlgo ){
	    	document.getElementById('log').innerHTML += '&lt;br/>Algorithm: ' + d.algoname+ '&lt;br/>Mode: ' + d.mode+ '&lt;br/>Threads: ' + d.threads;
	    }
	    
	    	
	    document.getElementById('performButton').disabled=false;
	    document.getElementById('stopButton').disabled=true;
	    
	}, function (err) {
	    // Error
	}, function (progress) {
	    // Progress
	}, function(){
	
	});
	
		
};


var is_array = function(someVar){
	return (Object.prototype.toString.call( someVar ) === '[object Array]');
};

window.jsonFormat = function(json,debug){
	try{
		var json = JSON.parse( json.replace(/ /g,'').replace(/\t/g,'') );
	} catch (error) {
		alert('data could not be parsed');
	}
	if( !is_array(json) ) {
		alert('enter a valid array to proceed');
		return false;
	}
	
	var text = JSON.stringify(json);
	text =  jsonColorize(text).replace(/\],\[/g,'],\n[');
	return text;
};
var jsonColorize = function(json){
 		json = json.replace(/&amp;/g, '&amp;amp;').replace(/&lt;/g, '&amp;lt;').replace(/>/g, '&amp;gt;');
 		    return json.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g, function (match) {
 		        var cls = 'number';
 		        if (/^"/.test(match)) {
 		            if (/:$/.test(match)) {
 		                cls = 'key';
 		            } else {
 		                cls = 'string';
 		            }
 		        } else if (/true|false/.test(match)) {
 		            cls = 'boolean';
 		        } else if (/null/.test(match)) {
 		            cls = 'null';
 		        }
 		        return '&lt;span class="' + cls + '">' + match + '&lt;/span>';
 		 });
 };
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-Application.html">Application</a></li><li><a href="module-Benchmark.html">Benchmark</a></li><li><a href="module-RandomWaypoints.html">RandomWaypoints</a></li><li><a href="module-TSP_API.html">TSP_API</a></li><li><a href="module-TSP_Solver.html">TSP_Solver</a></li><li><a href="module-TSP_Solver_Worker.html">TSP_Solver_Worker</a></li></ul><h3>Classes</h3><ul><li><a href="module-TSP_API-globals.TSP.html">TSP</a></li><li><a href="module-TSP_Solver_Worker-globals.tsp.html">tsp</a></li><li><a href="module-TSP_Solver_Worker-globals.TSP_Node_Calc.html">TSP_Node_Calc</a></li><li><a href="module-TSP_Solver-globals.TSP_Solver.html">TSP_Solver</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-beta3</a> on Mon Apr 13 2015 21:30:39 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
