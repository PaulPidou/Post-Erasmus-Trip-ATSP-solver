<!DOCTYPE html>
<html>
<head>
	<title>Javascript performance measurement on the fly (live measurement)</title>

	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<script>
	
		window.performance = window.performance || {};
		performance.now = (function() {
		  return performance.now       ||
		         performance.mozNow    ||
		         performance.msNow     ||
		         performance.oNow      ||
		         performance.webkitNow ||
		         function() { return new Date().getTime(); };
		})();
	
		var start = window.performance.now();
	
		window.onload = function(){
			
			
			var r = document.getElementById('performance_results');
			if(!r){
				var r = document.createElement('div');
				r.id = 'performance_results';
				r.className = 'block';
				r.style.position = 'absolute';
				r.style.top = '0px';
				r.style.left = '0px';
				r.style.zIndex = 10000;
				r.style.background = 'white';
				document.getElementsByTagName('body')[0].appendChild(r);
			}
			
			var duration = window.performance.now() - start;
			r.innerHTML += '<br/>duration: ' + duration +'<br/>';
			
			r.innerHTML += 'cores: ' + window.navigator.hardwareConcurrency+'<br/>';
			
			if( typeof window.performance === 'undefined' ){
				r.innerHTML += 'performance: not defined<br/>';
			} else {
				var t = '';
				for( var i in window.performance.timing ){
					if( i.indexOf( 'Start' ) !== -1 ){
						var k = i.replace('Start', '');
						if( typeof window.performance.timing[k+'End'] !== 'undefined' ){
							var d = window.performance.timing[k+'End'] - window.performance.timing[i];
							t += '<br/>'+k+' took '+d;
						} else {
							t += '<br/>'+i+': '+window.performance.timing[i];
						}
					} else if( i.indexOf( 'End' ) !== -1 ){
						continue;
					} else {
						t += '<br/>'+i+': '+window.performance.timing[i];
					}
				}
				
				r.innerHTML += 'performance: ' + JSON.stringify(window.performance) +'<br/>';
				r.innerHTML += t;
			}
			
			
			
			var time = window.performance.now(); //time in milliseconds
			for( var i = 0; i<100000000 ; i++ ){
				
			}
			var diff = window.performance.now()-time;
			r.innerHTML += '<br/>loop:'+diff;
			
			
		};
	
	</script>

	
</head>
<body>


</body>
</html>
